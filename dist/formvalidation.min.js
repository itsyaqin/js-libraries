export default class FormValidation{constructor(e={}){try{this._options={form:null,formEnclosure:"form-group",lang:"id"};for(let a in this._options)e.hasOwnProperty(a)&&(this._options[a]=e[a]);if(!this._options.form instanceof Element&&!this._options.form instanceof Document&&(this._options.form=document.querySelector(this._options.form)),!this._options.form)throw"Form not found!";this._options.form.onsubmit=(e=>{e.stopPropagation(),e.preventDefault(),this.validate()&&this._options.form.dispatchEvent(new Event("formvalidated"))})}catch(e){console.log(e)}}validate(){let e=!0;return this._options.form.querySelectorAll("[data-validation-rules]").forEach(a=>{if(["INPUT","SELECT","TEXTAREA"].includes(a.tagName)){this.message(a,"");let t=a.dataset.validationRules.split("|");for(let s in t){if("required"==t[s]&&!a.value){this.message(a,this._getMessage("required")),e=!1;break}if(t[s].startsWith("minlen")){let i=t[s].split("-");if(a.value.length<i[1]){this.message(a,this._getMessage("minlen",i[1])),e=!1;break}}if(t[s].startsWith("maxlen")){let i=t[s].split("-");if(a.value.length>i[1]){this.message(a,this._getMessage("maxlen",i[1])),e=!1;break}}if(["alpha","num","alphanum"].includes(t[s])){let i={alpha:/^[A-Za-z]+$/i,num:/^[0-9]+$/i,alphanum:/^[A-Za-z0-9]+$/i};if(!a.value.match(i[t[s]])){this.message(a,this._getMessage(t[s])),e=!1;break}}}}}),e}message(e,a=""){try{let t=e.closest(`.${this._options.formEnclosure}`);if(!t)throw"Form enclosure not found!";t.querySelector("._validationMessage")||t.insertAdjacentHTML("beforeend","<small class='_validationMessage' style='display:block;color:red'></small>"),t.querySelector("._validationMessage").innerHTML=a}catch(e){console.log(e)}}_getMessage(e,a){try{return{required:{id:"Isian tidak boleh kosong",en:"This field is required"},minlen:{id:`Minimal isian harus ${a} karakter`,en:`The input must be at least ${a} character(s)`},maxlen:{id:`Maksimal isian tak lebih dari ${a} karakter`,en:`The input must be no more than ${a} character(s)`},alpha:{id:"Karakter yang diperbolehkan hanya huruf",en:"The only characters allowed are letters"},num:{id:"Karakter yang diperbolehkan hanya angka",en:"The only characters allowed are numbers"},alphanum:{id:"Karakter yang diperbolehkan hanya huruf dan angka",en:"The only characters allowed are letters and numbers"}}[e][this._options.lang]}catch(e){return"Error message is not defined!"}}}